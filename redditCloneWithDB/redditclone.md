Клон Реддита

Продолжаем работать с клоном реддита.

Поскольку лекция посвящена работе с базами - в этот раз мы будем заниматься базами:

1) Хранить сессии в mysql. В JWT сессии использовать больше нельзя. Теперь они будут stateful ( храниться в базе ).
2) Хранить пользователей в mysql.
3) Хранить посты с комментами в MondoDB ( использовать github.com/mongodb/mongo-go-driver )

Для пользователей и постов надо написать тесты.
Надо сделать полное ( 100% ) покрытие структуры ( как http-хендлера, так и репозитория ).

Надо скопировать в соответствующую папку (7/99_hw/redditclone) ваш код из предыдущего задания (6/99_hw/redditclone) и писать в новой папке (7/99_hw/redditclone). Чтобы не смешивалось.

Ссылки в помощь:

* <https://medium.com/better-programming/unit-testing-code-using-the-mongo-go-driver-in-golang-7166d1aa72c0>

Это задание научит основным навыкам, которые используются при разработке приложений:

1) Проектировать простые таблицы в mysql
2) Писать основные запросы к mysql
3) Тестировать паттерн репозрторий с mysql и mongodb
4) Тестировать http хендлеры которые приближены к реальности, а не фейковые, как в 3-м задании

Опционально:

1) Хранить сессии в тарантуле
2) Хранить сесси в редисе ( <https://github.com/go-redis/redis> + <https://github.com/elliotchance/redismock>)
3) Хранить посты с комментами в mysql
4) Если использовать postgres, то моки через <https://github.com/pashagolub/pgxmock>

Реализовать это можно через отдельные структуры, удовлетворяющие заданному интерфейсу. Рядом с другим репозиторием, например будет session_jwt.go + session_mysql.go + session_redis.go

При покрытии тестами монги вы столкнетесь с тем что результат записывается в аргумент функции. Для этого в gomock есть функция SetArg - <https://godoc.org/github.com/golang/mock/gomock#Call.SetArg>
